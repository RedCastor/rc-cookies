{"version":3,"sources":["rc-cookies.js"],"names":["angular","module","directive","$injector","$log","$parse","restrict","require","link","scope","elem","attrs","Ctrl","cookie_name","rcCookie","cookie_days","rcCookieDays","cookie_val","formCtrl","$cookies","has","get","getObject","e","initForm","value","fields","$eval","rcCookieFields","isObject","extend","rcCookieInit","getter","setter","assign","saveCookie","name","obj","days","isString","length","remove","exipre_options","date","Date","setTime","getTime","expires","toGMTString","path","putObject","on","form_name","form","$valid","filter","cookie","$filter","options","isUndefined","parseInt","put","cookie_value","window"],"mappings":"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","file":"rc-cookies.js","sourcesContent":["(function(angular){\n    'use strict';\n\n    var module = angular.module('rcCookies', []);\n\n\n    module.directive('rcCookie', [\n        '$injector',\n        '$log',\n        '$parse',\n        function ($injector, $log, $parse) {\n            return {\n                restrict: \"A\",\n                require: ['?^form'],\n                link: function (scope, elem, attrs, Ctrl) {\n\n                    var cookie_name = attrs.rcCookie;\n                    var cookie_days = attrs.rcCookieDays || 7;\n                    var cookie_val = null;\n\n                    /**\n                     * Set the controllers for form\n                     */\n                    var formCtrl = Ctrl[0];\n\n                    //Use the current scope.\n                    //Only if attribute is set\n                    if (cookie_name && formCtrl) {\n\n                        var $cookies;\n\n                        //Inject cookies\n                        if ($injector.has('$cookies')) {\n                            $cookies = $injector.get('$cookies');\n\n                            try {\n                                cookie_val = $cookies.getObject(cookie_name);\n                            }\n                            catch (e) {\n                                cookie_val = $cookies.get(cookie_name);\n                            }\n\n                            if(!cookie_val) {\n                                cookie_val = null;\n                            }\n                        }\n\n\n                        /**\n                         * Set the model change from object.\n                         *\n                         * @param value\n                         */\n                        var initForm = function (value) {\n\n                            //Get fields form\n                            var fields = scope.$eval(attrs.rcCookieFields);\n\n                            if (angular.isObject(value) && angular.isObject(fields)) {\n                                angular.extend(fields, value);\n                            }\n                            else if (!value) {\n                                fields = scope.$eval(attrs.rcCookieInit);\n                            }\n                            else {\n                                fields = value;\n                            }\n\n                            var getter = $parse(attrs.rcCookieFields);\n                            var setter = getter.assign;\n                            setter(scope, fields);\n                        };\n\n\n                        /**\n                         * Save Cookie\n                         *\n                         * @param name\n                         * @param obj\n                         */\n                        var saveCookie = function (name, obj, days) {\n\n                            if (!$cookies || !angular.isObject(obj) || !angular.isString(name) || !name.length || days <= 0) {\n                                return false;\n                            }\n\n                            $cookies.remove(name);\n\n                            var exipre_options;\n                            var date = new Date();\n                            date.setTime(date.getTime()+( days * (24 * 60 * 60 * 1000) ));\n                            exipre_options = {\n                                expires: date.toGMTString(),\n                                path: '/'\n                            };\n\n                            $cookies.putObject(name, obj, exipre_options);\n                        };\n\n\n                        /**\n                         * Event Submit Form\n                         */\n                        elem.on('submit', function() {\n\n                            var fields = scope.$eval(attrs.rcCookieFields);\n                            var form_name = attrs.name;\n                            var form = scope.$eval(form_name);\n\n                            if (fields && (!form || form.$valid)) {\n                                saveCookie(cookie_name, fields, cookie_days);\n                            }\n                        });\n\n                        //Init Form\n                        initForm(cookie_val);\n                    }\n                }\n\n            };\n        }\n    ]);\n\n\n    module.filter('getCookie', ['$injector', function($injector) {\n\n        return function( name ) {\n\n            var cookie = null;\n\n            //Inject cookies\n            if (angular.isString(name) && name.length && $injector.has('$cookies')) {\n                var $cookies = $injector.get('$cookies');\n\n\n                try {\n                    cookie = $cookies.getObject(name);\n                }\n                catch (e) {\n                    cookie = $cookies.get(name);\n                }\n\n                if (!cookie) {\n                    cookie = null;\n                }\n            }\n\n            return cookie;\n        };\n    }]);\n\n\n    module.filter('setCookie', ['$injector', '$filter', '$log', function($injector, $filter, $log) {\n\n        return function( value, name, days, options ) {\n\n            days = angular.isUndefined(days) ? 0 : parseInt(days, 10);\n            options = angular.isObject(options) ? options : {};\n\n            //Inject cookies\n            if ( angular.isString(name) && name.length && $injector.has('$cookies') ) {\n\n                var $cookies = $injector.get('$cookies');\n\n                var exipre_options;\n                var date = new Date();\n                date.setTime(date.getTime()+( days * (24 * 60 * 60 * 1000) ));\n                exipre_options = {\n                    expires: date.toGMTString(),\n                    path: '/'\n                };\n\n                angular.extend(options, exipre_options);\n\n                $cookies.remove(name, options);\n\n                if (days) {\n                    if ( angular.isObject(value) ) {\n                        $cookies.putObject(name, value, options);\n                    }\n                    else {\n                        $cookies.put(name, value, options);\n                    }\n                }\n\n                var cookie_value = $filter('getCookie')(name);\n\n                if (!cookie_value) {\n                    return value;\n                }\n\n                return cookie_value;\n            }\n\n            return null;\n        };\n    }]);\n\n})(window.angular);\n"],"sourceRoot":"dist"}